
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>mutwo.core_parameters.abc &#8212; mutwo  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/classic.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/autoclasstoc.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">mutwo  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">mutwo.core_parameters.abc</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for mutwo.core_parameters.abc</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Abstract base classes for different parameters.</span>

<span class="sd">This module defines the public API of parameters.</span>
<span class="sd">Most other mutwo classes rely on this API. This means</span>
<span class="sd">when someone creates a new class inheriting from any of the</span>
<span class="sd">abstract parameter classes which are defined in this module,</span>
<span class="sd">she or he can make use of all other mutwo modules with this</span>
<span class="sd">newly created parameter class.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">typing</span>

<span class="kn">import</span> <span class="nn">quicktions</span> <span class="k">as</span> <span class="nn">fractions</span>
<span class="kn">import</span> <span class="nn">fractions</span> <span class="k">as</span> <span class="nn">_fractions</span>

<span class="kn">import</span> <span class="nn">ranges</span>

<span class="kn">from</span> <span class="nn">mutwo</span> <span class="kn">import</span> <span class="n">core_constants</span>
<span class="kn">from</span> <span class="nn">mutwo</span> <span class="kn">import</span> <span class="n">core_events</span>
<span class="kn">from</span> <span class="nn">mutwo</span> <span class="kn">import</span> <span class="n">core_parameters</span>
<span class="kn">from</span> <span class="nn">mutwo</span> <span class="kn">import</span> <span class="n">core_utilities</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;SingleValueParameter&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SingleNumberParameter&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ParameterWithEnvelope&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Duration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TempoPoint&quot;</span><span class="p">,</span>
<span class="p">)</span>


<div class="viewcode-block" id="ParameterWithEnvelope"><a class="viewcode-back" href="../../../api/mutwo.core_parameters.html#mutwo.core_parameters.abc.ParameterWithEnvelope">[docs]</a><span class="k">class</span> <span class="nc">ParameterWithEnvelope</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Abstract base class for all parameters with an envelope.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">envelope</span><span class="p">:</span> <span class="n">core_events</span><span class="o">.</span><span class="n">RelativeEnvelope</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">envelope</span> <span class="o">=</span> <span class="n">envelope</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">core_events</span><span class="o">.</span><span class="n">RelativeEnvelope</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_envelope</span>

    <span class="nd">@envelope</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_envelope</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_envelope</span><span class="p">,</span> <span class="n">core_events</span><span class="o">.</span><span class="n">RelativeEnvelope</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Found illegal object &#39;</span><span class="si">{</span><span class="n">new_envelope</span><span class="si">}</span><span class="s2">&#39; of not &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;supported type &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">new_envelope</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Only instances of &#39;</span><span class="si">{</span><span class="n">core_events</span><span class="o">.</span><span class="n">RelativeEnvelope</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
                <span class="s2">&quot; are allowed!&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_envelope</span> <span class="o">=</span> <span class="n">new_envelope</span>

<div class="viewcode-block" id="ParameterWithEnvelope.resolve_envelope"><a class="viewcode-back" href="../../../api/mutwo.core_parameters.html#mutwo.core_parameters.abc.ParameterWithEnvelope.resolve_envelope">[docs]</a>    <span class="k">def</span> <span class="nf">resolve_envelope</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">duration</span><span class="p">:</span> <span class="n">core_constants</span><span class="o">.</span><span class="n">DurationType</span><span class="p">,</span>
        <span class="c1"># XXX: We can&#39;t directly set the default attribute value,</span>
        <span class="c1"># but we have to do it with `None` and resolve it later,</span>
        <span class="c1"># because otherwise we will get a circular import</span>
        <span class="c1"># (core_parameters need to be imported before core_events,</span>
        <span class="c1">#  because we need core_parameters.Duration in core_events).</span>
        <span class="n">resolve_envelope_class</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">core_events</span><span class="o">.</span><span class="n">Envelope</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">core_events</span><span class="o">.</span><span class="n">Envelope</span><span class="p">:</span>
        <span class="n">resolve_envelope_class</span> <span class="o">=</span> <span class="n">resolve_envelope_class</span> <span class="ow">or</span> <span class="n">core_events</span><span class="o">.</span><span class="n">Envelope</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">envelope</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">duration</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">resolve_envelope_class</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SingleValueParameter"><a class="viewcode-back" href="../../../api/mutwo.core_parameters.html#mutwo.core_parameters.abc.SingleValueParameter">[docs]</a><span class="k">class</span> <span class="nc">SingleValueParameter</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Abstract base class for all parameters which are defined by one value.</span>

<span class="sd">    Classes which inherit from this base class have</span>
<span class="sd">    to provide an additional keyword argument `value_name`.</span>
<span class="sd">    Furthermore they can provide the optional keyword argument</span>
<span class="sd">    `value_return_type`.</span>

<span class="sd">    **Example:**</span>

<span class="sd">    &gt;&gt;&gt; from mutwo import core_parameters</span>
<span class="sd">    &gt;&gt;&gt; class Color(</span>
<span class="sd">    ...     core_parameters.abc.SingleValueParameter,</span>
<span class="sd">    ...     value_name=&quot;color&quot;,</span>
<span class="sd">    ...     value_return_type=str</span>
<span class="sd">    ... ):</span>
<span class="sd">    ...     def __init__(self, color: str):</span>
<span class="sd">    ...         self._color = color</span>
<span class="sd">    ...     @property</span>
<span class="sd">    ...     def color(self) -&gt; str:</span>
<span class="sd">    ...         return self._color</span>
<span class="sd">    &gt;&gt;&gt; red = Color(&#39;red&#39;)</span>
<span class="sd">    &gt;&gt;&gt; red.color</span>
<span class="sd">    &#39;red&#39;</span>
<span class="sd">    &gt;&gt;&gt; orange = Color(&#39;orange&#39;)</span>
<span class="sd">    &gt;&gt;&gt; red2 = Color(&#39;red&#39;)</span>
<span class="sd">    &gt;&gt;&gt; red == orange</span>
<span class="sd">    False</span>
<span class="sd">    &gt;&gt;&gt; red == red2</span>
<span class="sd">    True</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init_subclass__</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">value_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">value_return_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span>
    <span class="p">):</span>
        <span class="c1"># We will only add an abstract method with &quot;value_name&quot; in two</span>
        <span class="c1"># cases for the following reasons</span>
        <span class="c1">#</span>
        <span class="c1">#   1. If our value_name is empty we shouldn&#39;t add any new method.</span>
        <span class="c1">#      With this we can prevent that a new abstract property is created</span>
        <span class="c1">#      when no value_name is provided and the default value_name isn&#39;t</span>
        <span class="c1">#      empty. This would be a problem if for instance we would have the</span>
        <span class="c1">#      following inheritance structure:</span>
        <span class="c1">#</span>
        <span class="c1">#      SingleValueParameter -&gt;</span>
        <span class="c1">#</span>
        <span class="c1">#           Pitch(SingleValueParameter, value_name=&quot;frequency&quot;) -&gt;</span>
        <span class="c1">#</span>
        <span class="c1">#               MidiPitch(Pitch)</span>
        <span class="c1">#</span>
        <span class="c1">#       The last class shouldn&#39;t get any new abstract property (with</span>
        <span class="c1">#       a not-empty default name).</span>
        <span class="c1">#</span>
        <span class="c1">#   2. If the class already defines a method with the specific</span>
        <span class="c1">#      value_name it shouldn&#39;t be overridden (because the user already</span>
        <span class="c1">#      ensured there is a property). Overriding this manually defined property</span>
        <span class="c1">#      would lead to unexpected and undesired results.</span>
        <span class="k">if</span> <span class="n">value_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value_name</span><span class="p">):</span>

                <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
                <span class="k">def</span> <span class="nf">abstract_method</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">value_return_type</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span>

                <span class="nb">setattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value_name</span><span class="p">,</span> <span class="nb">property</span><span class="p">(</span><span class="n">abstract_method</span><span class="p">))</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;value_name&quot;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">core_utilities</span><span class="o">.</span><span class="n">AlreadyDefinedValueNameError</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>

            <span class="nb">setattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;value_name&quot;</span><span class="p">,</span> <span class="nb">property</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">value_name</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">value_name</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_name</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>  <span class="c1"># type: ignore</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_name</span><span class="p">)</span> <span class="o">==</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_name</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="SingleNumberParameter"><a class="viewcode-back" href="../../../api/mutwo.core_parameters.html#mutwo.core_parameters.abc.SingleNumberParameter">[docs]</a><span class="nd">@functools</span><span class="o">.</span><span class="n">total_ordering</span>
<span class="k">class</span> <span class="nc">SingleNumberParameter</span><span class="p">(</span><span class="n">SingleValueParameter</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Abstract base class for all parameters which are defined by one number.</span>

<span class="sd">    Classes which inherit from this base class have to override</span>
<span class="sd">    the same methods and properties as one have to override</span>
<span class="sd">    when inheriting from :class:`SingleValueParameter`.</span>

<span class="sd">    Furthermore the property `digit_to_round_to_count`</span>
<span class="sd">    can be overridden. This should return an integer or `None`.</span>
<span class="sd">    If it returns an integer it will first round two numbers</span>
<span class="sd">    before comparing them with the `==` or `&lt;` or `&lt;=` or `&gt;`</span>
<span class="sd">    or `&gt;=` operators.</span>
<span class="sd">    The default implementation always returns `None.</span>

<span class="sd">    **Example:**</span>

<span class="sd">    &gt;&gt;&gt; from mutwo import core_parameters</span>
<span class="sd">    &gt;&gt;&gt; class Speed(</span>
<span class="sd">    ...     core_parameters.abc.SingleNumberParameter,</span>
<span class="sd">    ...     value_name=&quot;meter_per_seconds&quot;,</span>
<span class="sd">    ...     value_return_type=float</span>
<span class="sd">    ... ):</span>
<span class="sd">    ...     def __init__(self, meter_per_seconds: float):</span>
<span class="sd">    ...         self._meter_per_seconds = meter_per_seconds</span>
<span class="sd">    ...     @property</span>
<span class="sd">    ...     def meter_per_seconds(self) -&gt; float:</span>
<span class="sd">    ...         return self._meter_per_seconds</span>
<span class="sd">    &gt;&gt;&gt; light_speed = Speed(299792458)</span>
<span class="sd">    &gt;&gt;&gt; sound_speed = Speed(343)</span>
<span class="sd">    &gt;&gt;&gt; light_speed &gt; sound_speed</span>
<span class="sd">    True</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">direct_comparison_type_tuple</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">digit_to_round_to_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_prepare_value_pair_for_comparison</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">value_pair</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">core_constants</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="n">core_constants</span><span class="o">.</span><span class="n">Real</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">core_constants</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="n">core_constants</span><span class="o">.</span><span class="n">Real</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span>
            <span class="n">core_utilities</span><span class="o">.</span><span class="n">round_floats</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">digit_to_round_to_count</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digit_to_round_to_count</span>
            <span class="k">else</span> <span class="n">value</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">value_pair</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_compare</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
        <span class="n">compare</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">core_constants</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="n">core_constants</span><span class="o">.</span><span class="n">Real</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span>
        <span class="n">raise_exception</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compare itself with other object&quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">value_pair</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_name</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
                <span class="n">other</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">direct_comparison_type_tuple</span><span class="p">)</span>
                <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_name</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">raise_exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Can&#39;t compare object &#39;</span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&#39; of type &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39; with&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot; object &#39;</span><span class="si">{</span><span class="n">other</span><span class="si">}</span><span class="s2">&#39; of type &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;!&quot;</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">value0</span><span class="p">,</span> <span class="n">value1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_value_pair_for_comparison</span><span class="p">(</span><span class="n">value_pair</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">compare</span><span class="p">(</span><span class="n">value0</span><span class="p">,</span> <span class="n">value1</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__float__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_name</span><span class="p">))</span>  <span class="c1"># type: ignore</span>

    <span class="k">def</span> <span class="fm">__int__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compare</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">value0</span><span class="p">,</span> <span class="n">value1</span><span class="p">:</span> <span class="n">value0</span> <span class="o">==</span> <span class="n">value1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compare</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">value0</span><span class="p">,</span> <span class="n">value1</span><span class="p">:</span> <span class="n">value0</span> <span class="o">&lt;</span> <span class="n">value1</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="Duration"><a class="viewcode-back" href="../../../api/mutwo.core_parameters.html#mutwo.core_parameters.abc.Duration">[docs]</a><span class="k">class</span> <span class="nc">Duration</span><span class="p">(</span>
    <span class="n">SingleNumberParameter</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;duration&quot;</span><span class="p">,</span> <span class="n">value_return_type</span><span class="o">=</span><span class="s2">&quot;fractions.Fraction&quot;</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Abstract base class for any duration.</span>

<span class="sd">    If the user wants to define a Duration class, the abstract</span>
<span class="sd">    property :attr:`duration` has to be overridden.</span>

<span class="sd">    The attribute :attr:`duration` is stored in unit `beats`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">direct_comparison_type_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">,</span> <span class="n">_fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_math_operation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DurationOrReal</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Duration</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">(</span>
            <span class="n">operation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">&quot;duration&quot;</span><span class="p">,</span> <span class="n">other</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

<div class="viewcode-block" id="Duration.add"><a class="viewcode-back" href="../../../api/mutwo.core_parameters.html#mutwo.core_parameters.abc.Duration.add">[docs]</a>    <span class="nd">@core_utilities</span><span class="o">.</span><span class="n">add_copy_option</span>
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DurationOrReal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Duration</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math_operation</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">)</span></div>

<div class="viewcode-block" id="Duration.subtract"><a class="viewcode-back" href="../../../api/mutwo.core_parameters.html#mutwo.core_parameters.abc.Duration.subtract">[docs]</a>    <span class="nd">@core_utilities</span><span class="o">.</span><span class="n">add_copy_option</span>
    <span class="k">def</span> <span class="nf">subtract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DurationOrReal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Duration</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math_operation</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">sub</span><span class="p">)</span></div>

<div class="viewcode-block" id="Duration.multiply"><a class="viewcode-back" href="../../../api/mutwo.core_parameters.html#mutwo.core_parameters.abc.Duration.multiply">[docs]</a>    <span class="nd">@core_utilities</span><span class="o">.</span><span class="n">add_copy_option</span>
    <span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DurationOrReal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Duration</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math_operation</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">mul</span><span class="p">)</span></div>

<div class="viewcode-block" id="Duration.divide"><a class="viewcode-back" href="../../../api/mutwo.core_parameters.html#mutwo.core_parameters.abc.Duration.divide">[docs]</a>    <span class="nd">@core_utilities</span><span class="o">.</span><span class="n">add_copy_option</span>
    <span class="k">def</span> <span class="nf">divide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DurationOrReal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Duration</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math_operation</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">truediv</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DurationOrReal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Duration</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">mutate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DurationOrReal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Duration</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">mutate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DurationOrReal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Duration</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">mutate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DurationOrReal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Duration</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">mutate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__float__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">core_utilities</span><span class="o">.</span><span class="n">round_floats</span><span class="p">(</span>
            <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">),</span>
            <span class="n">core_parameters</span><span class="o">.</span><span class="n">configurations</span><span class="o">.</span><span class="n">ROUND_DURATION_TO_N_DIGITS</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">duration_in_floats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">duration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@duration</span><span class="o">.</span><span class="n">setter</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">duration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duration</span><span class="p">:</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">):</span>
        <span class="o">...</span></div>


<span class="n">DurationOrReal</span> <span class="o">=</span> <span class="n">Duration</span> <span class="o">|</span> <span class="n">core_constants</span><span class="o">.</span><span class="n">Real</span>


<div class="viewcode-block" id="TempoPoint"><a class="viewcode-back" href="../../../api/mutwo.core_parameters.html#mutwo.core_parameters.abc.TempoPoint">[docs]</a><span class="k">class</span> <span class="nc">TempoPoint</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represent the active tempo at a specific moment in time.</span>

<span class="sd">    If the user wants to define a `TempoPoint` class, the abstract</span>
<span class="sd">    properties :attr:`tempo_or_tempo_range_in_beats_per_minute`</span>
<span class="sd">    and `reference` have to be overridden.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">(BPM = </span><span class="si">{}</span><span class="s2">, reference = </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tempo_in_beats_per_minute</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">attribute_to_compare_tuple</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;tempo_in_beats_per_minute&quot;</span><span class="p">,</span>
            <span class="s2">&quot;reference&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">core_utilities</span><span class="o">.</span><span class="n">test_if_objects_are_equal_by_parameter_tuple</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">attribute_to_compare_tuple</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">tempo_or_tempo_range_in_beats_per_minute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">core_parameters</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">TempoOrTempoRangeInBeatsPerMinute</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@property</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">reference</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">core_constants</span><span class="o">.</span><span class="n">Real</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tempo_in_beats_per_minute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">core_parameters</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">TempoInBeatsPerMinute</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get tempo in `beats per minute &lt;https://en.wikipedia.org/wiki/Tempo#Measurement&gt;`_</span>

<span class="sd">        If :attr:`tempo_or_tempo_range_in_beats_per_minute` is a range</span>
<span class="sd">        mutwo will return the minimal tempo.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tempo_or_tempo_range_in_beats_per_minute</span><span class="p">,</span> <span class="n">ranges</span><span class="o">.</span><span class="n">Range</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tempo_or_tempo_range_in_beats_per_minute</span><span class="o">.</span><span class="n">start</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tempo_or_tempo_range_in_beats_per_minute</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">absolute_tempo_in_beats_per_minute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get absolute tempo in `beats per minute &lt;https://en.wikipedia.org/wiki/Tempo#Measurement&gt;`_</span>

<span class="sd">        The absolute tempo takes the :attr:`reference` of the :class:`TempoPoint`</span>
<span class="sd">        into account.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tempo_in_beats_per_minute</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference</span></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">mutwo  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">mutwo.core_parameters.abc</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, Levin Eric Zimmermann.
    </div>
  </body>
</html>